<?php
$ctrl = $this->uri->segment(1);
$action = $this->uri->segment(2);
if($this->nsession->userdata('member_session_membertype')==1){
    $profile_link = base_url('member/profile');
}else{
    $profile_link = base_url('counselor/dashboard');
}
?>
<header class="main-header">
    <div class="container">
        <div class="row">
            <div class="col-md-2 ">
                <div class="logo"> <a href="<?php echo base_url(); ?>"><img src="<?php echo CSS_IMAGES_JS_BASE_URL;?>images/dashboard-logo.png" class="img-responsive" alt=""></a> </div>
            </div>
            <div class="col-md-10">
                <div class="navbar-custom-menu hidden-xs">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
						
					<?php if($memberData['member_type']== 1) {?>
						
                        <li class="search-menu" > <a href="#" data-toggle="modal" data-target="#searchpopup" > <i class="fa fa-search" ></i> <span class="nav-text"> Search </span> </a> </li>
						
					<?php } ?>
						
					<?php if($memberData['member_type']== 1) {?>
					
                       <!-- <li class="messages-menu"> <a href="#"> <i class="fa fa-comments"></i> <span class="nav-text">Messages</span> </a> </li>-->
						
					<?php } ?>
						
                        <li class="interest-menu"> 
						
							<?php if($memberData['member_type']== 1) {?>
							
							<a href="#" data-toggle="modal" data-target="#interests">
								<i class="fa fa-heart"></i>
								<span class="nav-text">Interests</span>
							</a> 
							
							<?php } ?>
							
							 <!-- Modal interests -->
							 <div class="modal fade" id="interests" role="dialog">
									<div class="modal-dialog">
									
									  <!-- Modal content-->
									  <div class="modal-content">
									 
										<div class="modal-header">
										
										  <button type="button" class="close" data-dismiss="modal">&times;</button>
										  <h4 class="modal-title">Interests</h4>
										</div>
										<div class="modal-body">
										  <ul>
										  <?php

											$member_interest = get_interest_member();
											
											//pr($member_interest);	
											$interest_arr=array();
											if(!empty($member_interest))
											{
												foreach($member_interest as $interestval)
												{
													$interest_arr[]=$interestval['interest_id'];
												}
											}
												
											$allinterest=get_interest();										 
											foreach ($allinterest as $details){?>									  
											<li class="interest_li <?php echo (in_array($details['id'],$interest_arr))?"checked_interest":"";?>" >
										 <form class="subscribe-frm" name="counselor_booking1" a method="post" id="counselor_booking1">		
											<input type="hidden" value="<?php echo $this->nsession->userdata('member_session_id');?>" name="member_id">
											<input type="checkbox" class="interest_chk" style="display:none;" value="<?php echo $details['id']; ?>" name="interest_chk[]" <?php echo (in_array($details['id'],$interest_arr))?"checked":"";?>> <?php echo $details['name']; ?></li>
											
										  <?php } ?>
											
										  </ul>
										  <input type="submit" class="showTipsBtn" value="Save">
										  
										</div>
									   </form>
									  </div>
									  
									</div>
								  </div>
						  <!-- Modal -->
							
							
							
						
						
						</li>
                    </ul>
                </div>
                <div class="pull-right "> <?php if($memberData['member_type']== 1) {?> <a href="<?php echo base_url('member/membershipplan')?>" class="btn btn-login">Upgrade</a> <?php } ?>
                    <div class="btn-group profile-menu">
                        <button type="button" class="btn btn-user dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-user" aria-hidden="true"></i> <i class="fa fa-angle-down" aria-hidden="true"></i> </button>
                        <ul class="dropdown-menu">
                            <li><a href="<?php echo $profile_link;?>">Profile</a></li>
                            <li><a href="<?php echo base_url('logout')?>">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
$(document).ready(function(){
	$(".interest_li").click(function(){
		var interest_li=$(this).val();
		//alert($(this).find(".interest_chk").prop("checked"));
		if($(this).find(".interest_chk").prop("checked") == true)
		{
			$(this).find(".interest_chk").attr("checked",false);
			$(this).removeClass("checked_interest");
			
		}
		else
		{
			$(this).find(".interest_chk").attr("checked",true);
			$(this).addClass("checked_interest");
		}
		
	})
	
})
</script>

<script type="text/javascript">
$(function() {

  $("#counselor_booking1").validate({
    rules: {
        interest_chk: {
  		  required: true
  	  }
    },
    submitHandler: function(form) {
      var data=$("form[name='counselor_booking1']").serialize();
      do_subscribe1(data,'Subscribe');
    }
  });
});


function do_subscribe1(formData,type){
       
         var url="<?php echo base_url('member/interest/');?>";
       
		// var btnname='make'+type+'Register';
	   
        $.ajax({
          type:'POST',
          url: url,
          data:formData,
        
          success:function(msg){ //alert(11);
           
            var response=$.parseJSON(msg);
		
            if(response){ 
              
             $('#booknowpop').modal('toggle');
            
              /*messagealert('Success','We have sent a verification email to your mail id, please check your email to active account.','success');*/
			  window.location.reload();
            }else{
				 //$('#booknowpop').modal('toggle');
                //messagealert('Error','You are already booked','error');
				window.location.reload();
			}
          },
          error: function () {
            
            messagealert('Error','Technical issue , Please try later','error');
          }
        });
      }
	</script>

